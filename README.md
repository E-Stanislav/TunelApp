# TunelApp - VLESS VPN –¥–ª—è Android

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –Ω–∞—Ç–∏–≤–Ω–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è VLESS VPN —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ –∏ Android TV.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ VLESS
- ‚úÖ –ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Material Design 3 UI
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Android TV —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è D-pad
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã
- **–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã**: Android 5.0+ (API 21+)
- **Android TV**: Leanback –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

### üé® –î–∏–∑–∞–π–Ω
- Material Design 3 —Å Dynamic Colors
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ç–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **–Ø–∑—ã–∫**: Kotlin 100%
- **UI**: Jetpack Compose
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: MVVM
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: Room
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: Kotlin Coroutines & Flow
- **DI**: Manual (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Hilt/Koin)
- **VPN Core**: Xray-core (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
TunelApp/
‚îú‚îÄ‚îÄ app/src/main/java/com/tunelapp/
‚îÇ   ‚îú‚îÄ‚îÄ core/              # VPN –ª–æ–≥–∏–∫–∞ –∏ Xray –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ data/              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ parser/            # VLESS URL –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ service/           # VPN —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mobile/        # UI –¥–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tv/            # UI –¥–ª—è Android TV
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ theme/         # –¢–µ–º–∞ Material Design 3
‚îÇ   ‚îî‚îÄ‚îÄ viewmodel/         # ViewModels
‚îú‚îÄ‚îÄ app/src/tv/            # TV-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
‚îî‚îÄ‚îÄ app/libs/              # Xray –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è)
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Android Studio Hedgehog –∏–ª–∏ –Ω–æ–≤–µ–µ
- JDK 17
- Android SDK 34
- Gradle 8.2+

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   cd /Users/stanislave/Documents/Projects/TunelApp
   ```

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Xray-core** (–≤–∞–∂–Ω–æ!)
   
   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É Xray –¥–ª—è —Ä–∞–±–æ—Ç—ã VPN. –°–º. `app/libs/README.md` –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
   
   –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
   - –°–∫–∞—á–∞–π—Ç–µ libXray.aar
   - –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ `app/libs/`
   - –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ `app/build.gradle.kts`

3. **–û—Ç–∫—Ä—ã—Ç—å –≤ Android Studio**
   ```bash
   open -a "Android Studio" .
   ```

4. **–í—ã–±—Ä–∞—Ç—å Build Variant**
   - `mobileDebug` - –¥–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ (–æ—Ç–ª–∞–¥–∫–∞)
   - `mobileRelease` - –¥–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ (—Ä–µ–ª–∏–∑)
   - `tvDebug` - –¥–ª—è Android TV (–æ—Ç–ª–∞–¥–∫–∞)
   - `tvRelease` - –¥–ª—è Android TV (—Ä–µ–ª–∏–∑)

5. **–°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å**
   ```bash
   # –î–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞
   ./gradlew assembleMobileDebug
   
   # –î–ª—è TV
   ./gradlew assembleTvDebug
   ```

### –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ APK

–î–ª—è —Ä–µ–ª–∏–∑–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Å–æ–∑–¥–∞–π—Ç–µ keystore:
```bash
keytool -genkey -v -keystore tunelapp.keystore -alias tunelapp -keyalg RSA -keysize 2048 -validity 10000
```

–î–æ–±–∞–≤—å—Ç–µ –≤ `app/build.gradle.kts`:
```kotlin
signingConfigs {
    create("release") {
        storeFile = file("tunelapp.keystore")
        storePassword = "your_password"
        keyAlias = "tunelapp"
        keyPassword = "your_password"
    }
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–º–ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ VLESS URL** –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞:
   ```
   vless://uuid@server.com:443?encryption=none&security=tls&type=ws&host=server.com&path=/path#MyServer
   ```

2. **–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**:
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "+" (FAB) –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ
   - –ò–ª–∏ "IMPORT FROM CLIPBOARD" –Ω–∞ TV
   - –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

1. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
2. –ù–∞–∂–º–∏—Ç–µ –±–æ–ª—å—à—É—é –∫–Ω–æ–ø–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. –†–∞–∑—Ä–µ—à–∏—Ç–µ VPN –¥–æ—Å—Ç—É–ø (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
4. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å—Ç–∞—Ç—É—Å–∞ "CONNECTED"

### –§–æ—Ä–º–∞—Ç VLESS URL

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç:
```
vless://UUID@ADDRESS:PORT?param1=value1&param2=value2#NAME
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `type`: tcp, ws, grpc, http, quic
- `security`: none, tls, reality
- `encryption`: none (–æ–±—ã—á–Ω–æ)
- `flow`: xtls-rprx-vision –∏ –¥—Ä.
- `sni`: Server Name Indication
- `fp`: TLS fingerprint
- `alpn`: Application-Layer Protocol Negotiation
- `path`: WebSocket path
- `host`: WebSocket/HTTP host
- `serviceName`: gRPC service name

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
1. –û–±–Ω–æ–≤–∏—Ç–µ `VlessServer.kt` —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
2. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥ –≤ `VlessParser.kt`
3. –û–±–Ω–æ–≤–∏—Ç–µ `XrayConfig.kt` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ `XrayJNI.getStats()` –≤ `XrayManager.kt`
2. –û–±–Ω–æ–≤–∏—Ç–µ `TrafficStats` –≤ `VlessServer.kt`
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ `MainViewModel.kt`
4. –û–±–Ω–æ–≤–∏—Ç–µ UI –≤ `MainScreen.kt`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit —Ç–µ—Å—Ç—ã
./gradlew test

# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
./gradlew connectedAndroidTest

# Lint –ø—Ä–æ–≤–µ—Ä–∫–∞
./gradlew lint
```

### –û—Ç–ª–∞–¥–∫–∞ VPN

–õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ Logcat:
```bash
adb logcat -s TunelVpnService XrayManager MainViewModel
```

## TODO

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ Xray-core
- [ ] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è packet forwarding —á–µ—Ä–µ–∑ SOCKS proxy
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] Split tunneling (–≤—ã–±–æ—Ä–æ—á–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –¢–µ—Å—Ç—ã —Å–∫–æ—Ä–æ—Å—Ç–∏
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ–±–ª–∞–∫–æ
- [ ] –í–∏–¥–∂–µ—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [ ] Shortcuts –¥–ª—è Android
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Xray –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω**: –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å libXray.aar –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
2. **Packet forwarding**: Stub —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, —Ç—Ä–µ–±—É–µ—Ç—Å—è tun2socks –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0, –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–≤—è–∑—å —Å Xray

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ VPN —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –ë–î
- ‚úÖ –ù–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
- ‚ö†Ô∏è UUID —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (–º–æ–∂–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å)
- ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω SSL Pinning

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.

## –†–µ—Å—É—Ä—Å—ã

- [Xray Documentation](https://xtls.github.io/)
- [Android VPN Guide](https://developer.android.com/guide/topics/connectivity/vpn)
- [Jetpack Compose](https://developer.android.com/jetpack/compose)
- [Material Design 3](https://m3.material.io/)

## –ê–≤—Ç–æ—Ä—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π Android —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å Kotlin –∏ Jetpack Compose.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã"
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Xray –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ adb logcat
4. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∞ VLESS URL

---

**–í–∞–∂–Ω–æ**: –≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Xray-core –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç stub —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ UI/UX.
